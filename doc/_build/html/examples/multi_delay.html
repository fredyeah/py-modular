
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. Using more effects and programmatic sound system creation &#8212; py-modular  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="3. Create a ping sound with multiple fm controls" href="sequence_and_ping_sound.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">py-modular</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Examples
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="random_sine_wave.html">
   1. How to create a sine wave with random pitch oscillation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simple_kick_drum.html">
   2. How to create a basic kick drum with pitch and gain envelopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sequence_and_ping_sound.html">
   3. Create a ping sound with multiple fm controls
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. Using more effects and programmatic sound system creation
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="using-more-effects-and-programmatic-sound-system-creation">
<h1><span class="section-number">4. </span>Using more effects and programmatic sound system creation<a class="headerlink" href="#using-more-effects-and-programmatic-sound-system-creation" title="Permalink to this headline">Â¶</a></h1>
<p>This tutorial will go into some more interesting use cases for <cite>py-modular</cite> and hopefully demonstrate concepts where <cite>py-modular</cite> can shine in comparison to traditional music creation environments.
We will be building off the previous tutorials, and implementing some more effects and programmatic system designs.
First, we need to import some nodes to create the sound system and a utility function to generate random numbers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">py_modular.time.transport</span> <span class="kn">import</span> <span class="n">GlobalTransport</span>
<span class="kn">from</span> <span class="nn">py_modular.sound.oscillators</span> <span class="kn">import</span> <span class="n">Tri</span><span class="p">,</span> <span class="n">Random</span>
<span class="kn">from</span> <span class="nn">py_modular.effects.mixer</span> <span class="kn">import</span> <span class="n">Atten</span>
<span class="kn">from</span> <span class="nn">py_modular.effects.dsp</span> <span class="kn">import</span> <span class="n">MultiChannelDelay</span>
<span class="kn">from</span> <span class="nn">py_modular.time.events</span> <span class="kn">import</span> <span class="n">TriggerEvent</span>
<span class="kn">from</span> <span class="nn">py_modular.time.envelopes</span> <span class="kn">import</span> <span class="n">ExpEnv</span>
<span class="kn">from</span> <span class="nn">py_modular.time.transport</span> <span class="kn">import</span> <span class="n">EventSequencer</span>

<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
</pre></div>
</div>
<p>We will essentially copy most of the design from the last tutorial and implement it as a function.
Each time we call this function, we will create another instance of the ping sound, but each created instance will be slightly different because of the random oscillator.
Additionally, we will use the <cite>randint</cite> method to generate random event sequences for each instance of the ping sound.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_ping_sound</span><span class="p">():</span>
    <span class="n">pitch_variation</span> <span class="o">=</span> <span class="n">Random</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mf">0.76</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
    <span class="n">pitch_envelope</span> <span class="o">=</span> <span class="n">ExpEnv</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">curve_gain</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">gain_envelope</span> <span class="o">=</span> <span class="n">ExpEnv</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">curve_gain</span><span class="o">=</span><span class="mf">0.92</span><span class="p">)</span>
    <span class="n">trigger</span> <span class="o">=</span> <span class="n">TriggerEvent</span><span class="p">([</span><span class="n">pitch_envelope</span><span class="p">,</span> <span class="n">gain_envelope</span><span class="p">])</span>
    <span class="n">sequencer</span> <span class="o">=</span> <span class="n">EventSequencer</span><span class="p">([</span><span class="n">trigger</span><span class="p">],</span> <span class="n">sequence</span><span class="o">=</span><span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">60000</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">))])</span>
    <span class="n">ping_sound</span> <span class="o">=</span> <span class="n">Tri</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mf">250.0</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">gainct</span><span class="o">=</span><span class="n">gain_envelope</span><span class="p">,</span> <span class="n">fmct</span><span class="o">=</span><span class="p">[</span><span class="n">pitch_envelope</span><span class="p">,</span> <span class="n">pitch_variation</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ping_sound</span><span class="p">,</span> <span class="n">sequencer</span>
</pre></div>
</div>
<p>Then we will define some number of pings to create.
This can be any number, but since <cite>py-modular</cite> is not very optimized for real time performance at the time of writing this, the larger the number, the more audio buffer underruns will occur.
Even with just one ping, we should get an interesting result.
We also will create some lists so that we can store ping and event instances along the way</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">num_pings</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">event_handlers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sounds</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<p>We can iterate through our number of pings to create and store the returned instances in the previous lists.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pings</span><span class="p">):</span>
    <span class="n">sound</span><span class="p">,</span> <span class="n">sequencer</span> <span class="o">=</span> <span class="n">get_ping_sound</span><span class="p">()</span>
    <span class="n">event_handlers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequencer</span><span class="p">)</span>
    <span class="n">sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sound</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we add in the best part, the <cite>MultiChannelDelay</cite>.
The delay takes an array of sounds to be processed, in this case our generated pings, a list of delay times for each channel in samples, and a value for delay feedback.
For feedback, somewhere between 1.1 and 1.3 will give a good atmospheric result.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">delay</span> <span class="o">=</span> <span class="n">MultiChannelDelay</span><span class="p">(</span><span class="n">sounds</span><span class="p">,</span> <span class="p">[</span><span class="mi">8477</span><span class="p">,</span> <span class="mi">30298</span><span class="p">],</span> <span class="mf">1.32</span><span class="p">)</span>
</pre></div>
</div>
<p>We can then create our global transport with the event handlers.
To add the delay, we will just add the node to both channels of the global transport.
Since it is a multichannel delay, it will take care of deciding which sounds go to which channels.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">global_transport</span> <span class="o">=</span> <span class="n">GlobalTransport</span><span class="p">(</span><span class="n">event_handlers</span><span class="p">)</span>
<span class="n">global_transport</span><span class="o">.</span><span class="n">chs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
<span class="n">global_transport</span><span class="o">.</span><span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>

<span class="n">global_transport</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since <cite>py-modular</cite> is not optimized for real time performance yet, this tutorial may perform poorly on computers that are not high performance.
We recommend using the recording utilities to create .wav files and listen back to the results that way for now.</p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="sequence_and_ping_sound.html" title="previous page"><span class="section-number">3. </span>Create a ping sound with multiple fm controls</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, fredyeah.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>